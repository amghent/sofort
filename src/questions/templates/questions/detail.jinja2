{% extends "base.jinja2" %}

{% from "questions/settings.jinja2" import sf_questions %}
{% from "core/common.jinja2" import sf_common %}

{% block sidebar %}
    {% include "includes/interests/sidebar.jinja2" %}
{% endblock %}

{% block content %}
    <div id="content-wrapper" class="container-fluid">
        <div class="row">
            <article>
                <header class="{{ sf_questions.layout.detail.question.header }}">
                    <h1>{{ question.title }}</h1>
                    <div class="{{ sf_questions.layout.detail.question.user_date }}">
                        {{ question.created_at | dt_to_user_frmt }} - {{ question.author }}</div>
                    <!-- for tags
                    <a class="badge bg-secondary text-decoration-none link-light" href="#!">Web Design</a -->
                </header>

                <section class="{{ sf_questions.layout.detail.question.section }}">
                    <label>
                        <textarea class="disabled">{{ question.text }}</textarea>
                    </label>
                </section>
            </article>

            <section>
                <div class="{{ sf_questions.layout.detail.answers.wrapper }}">

                    {% for a in answers %}
                        <div class="{{ sf_questions.layout.detail.answer.wrapper }}">
                            <div class="{{ sf_common.layout.avatar.wrapper }}">
                                <img class="{{ sf_common.layout.avatar.image }}"
                                     src="https://dummyimage.com/50x50/ced4da/6c757d.jpg"
                                     alt="{{ a.author }}" />
                            </div>
                            <div class="{{ sf_questions.layout.detail.discussions.wrapper }} w-100">
                                <div class="{{ sf_questions.layout.detail.answer.author }}">
                                    {{ a.author }} - {{ a.created_at | dt_to_user_frmt }}</div>
                                <label>
                                    <textarea class="disabled">{{ a.text }}</textarea>
                                </label>

                                {% for r in replies %}
                                    {% if r.question_answer == a %}
                                        <div class="{{ sf_questions.layout.detail.discussion.wrapper }}">
                                            <div class="{{ sf_common.layout.avatar.wrapper }}">
                                                <img class="{{ sf_common.layout.avatar.image }}"
                                                     src="https://dummyimage.com/50x50/ced4da/6c757d.jpg"
                                                     alt="{{ r.author }}" />
                                            </div>
                                            <div class="{{ sf_questions.layout.detail.discussion.text }}">
                                                <div class="{{ sf_questions.layout.detail.discussion.author }}">
                                                    {{ r.author }} - {{ r.created_at | dt_to_user_frmt }}</div>
                                                <label>
                                                    <textarea class="disabled">{{ r.text }}</textarea>
                                                </label>
                                            </div>
                                        </div>
                                    {% endif %}
                                {% endfor %}

                                <form method="POST" action="{{ url('questions_reply', args=[interest_group.slug, question.id, a.id]) }}">
                                    <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}"/>

                                    <label>
                                        <textarea id="reply_text" name="reply_text" class="form-control tiny_question_reply" placeholder="Reply to this answer">
                                        </textarea>
                                    </label>
                                    <button type="submit" class="{{ sf_common.layout.submit_button }}">Submit your reply</button>
                                </form>
                            </div>
                        </div>
                    {% endfor %}

                    <form method="POST" action="{{ url('questions_answer', args=[interest_group.slug, question.id]) }}">
                        <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}"/>
                        <label>
                            <textarea id="answer_text" name="answer_text" class="form-control tiny_question_answer"
                                      placeholder="Your answer goes there"></textarea>
                        </label>

                        <button type="submit" class="{{ sf_common.layout.submit_button }}">Submit your answer</button>
                    </form>
                </div>
            </section>
        </div>
    </div>
{% endblock %}
