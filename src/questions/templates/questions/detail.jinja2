{% extends "base.jinja2" %}

{% block sidebar %}
    {% include "includes/interests/sidebar.jinja2" %}
{% endblock %}

{% block content %}
    <div id="content-wrapper" class="container-fluid">
        <div class="row">
            <article>
                <header class="mb-3">
                    <h1>{{ question.title }}</h1>
                    <div class="text-muted fst-italic mb-2">
                        {{ question.created_at | dt_to_user_frmt }} - {{ question.author }}</div>
                    <!-- for tags
                    <a class="badge bg-secondary text-decoration-none link-light" href="#!">Web Design</a -->
                </header>

                <section class="mb-3">
                    <label>
                        <textarea class="disabled">{{ question.text }}</textarea>
                    </label>
                </section>
            </article>

            <section>
                <div class="card card-body bg-light">

                    {% for a in answers %}
                        <div class="d-flex flex-row mb-4">
                            <div class="flex-shrink-0">
                                <img class="rounded-circle"
                                     src="https://dummyimage.com/50x50/ced4da/6c757d.jpg"
                                     alt="{{ a.author }}" />
                            </div>
                            <div class="ms-2">
                                <div class="fw-bold">
                                    {{ a.author }} - {{ a.created_at | dt_to_user_frmt }}</div>
                                <label>
                                    <textarea class="disabled">{{ a.text }}</textarea>
                                </label>

                                {% for d in discussions %}
                                    {% if d.question_answer == a %}
                                        <div class="d-flex flex-row mt-2">
                                            <div class="flex-shrink-0">
                                                <img class="rounded-circle"
                                                     src="https://dummyimage.com/50x50/ced4da/6c757d.jpg"
                                                     alt="{{ r.author }}" />
                                            </div>
                                            <div class="ms-2">
                                                <div class="fw-bold">
                                                    {{ d.author }} - {{ d.created_at | dt_to_user_frmt }}</div>
                                                <p>{{ d.text }}</p>
                                            </div>
                                        </div>
                                    {% endif %}
                                {% endfor %}

                                <form method="POST" action="{{ url('questions_reply', args=[interest_group.slug, question.id, a.id]) }}">
                                    <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}"/>

                                    <label>
                                        <textarea id="reply_text" name="reply_text" class="form-control tiny_question_reply" placeholder="Reply to this answer">
                                        </textarea>
                                    </label>
                                    <button type="submit" class="{{ sf_common.layout.submit_button }}">Submit your reply</button>
                                </form>
                            </div>
                        </div>
                    {% endfor %}

                    <form method="POST" action="{{ url('questions_answer', args=[interest_group.slug, question.id]) }}">
                        <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}"/>
                        <label>
                            <textarea id="answer_text" name="answer_text" class="form-control tiny_question_answer"
                                      placeholder="Your answer goes there"></textarea>
                        </label>

                        <button type="submit" class="{{ sf_common.layout.submit_button }}">Submit your answer</button>
                    </form>
                </div>
            </section>
        </div>
    </div>
{% endblock %}
