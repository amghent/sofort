{#####
#
#   Version:    1.0.0
#   Date:       2022-08-01
#   Author:     Yves Vindevogel
#
#####}

{% macro get_submit_button(_btn) %}
    {% if _btn is mapping %}
        <button type="submit" class="btn btn-primary btn-sm mt-2">{{ _btn.button_text }}</button>
    {% else %}
        <button type="submit" class="btn btn-primary btn-sm mt-2">{{ _btn }}</button>
    {% endif %}
{% endmacro %}

{% macro get_csrf_security(_token) %}
    {% if _token is mapping %}
        <input type="hidden" name="csrfmiddlewaretoken" value="{{ _token.token }}"/>
    {% else %}
        <input type="hidden" name="csrfmiddlewaretoken" value="{{ _token }}"/>
    {% endif %}
{% endmacro %}

{% macro get_form(_form) %}
    <form id="{{ _form.id }}" method="POST" action="{{ _form.post_url }}">
        {{ get_csrf_security({"token": _form.csrf_token}) }}

        {% for field in _form.fields %}
            <label for="{{ field.id }}" class="form-label">{{ field.label }}</label>

            {% if field.type == "required_text" %}
                <input type="text" id="{{ field.id }}" name="{{ field.name }}" class="form-text {{ field.width }}"
                       required data-validation-required-message="{{ field.required_message }}"/>
            {% endif %}

            {% if field.type == "password" %}
                <input type="password" id="{{ field.id }}" name="{{ field.name }}" class="form-text {{ field.width }}"
                       required data-validation-required-message="{{ field.required_message }}"/>
            {% endif %}

            {% if field.type == "required_textarea" %}
                <textarea id="{{ field.id }}" name="{{ field.name }}" class="tiny_enabled form-text"
                          required data-validation-required-message="{{ field.required_message }}"></textarea>
            {% endif %}

            {% if field.help_message %}
                <div id="{{ field.id }}_help" class="form-text">{{ field.help_message }}</div>
            {% endif %}
        {% endfor %}

        {{ get_submit_button({"button_text": _form.submit_button_text}) }}
    </form>
{% endmacro %}